\hypertarget{namespacemod__loops}{}\section{mod\+\_\+loops Module Reference}
\label{namespacemod__loops}\index{mod\+\_\+loops@{mod\+\_\+loops}}


This module contains the main program loop for Z(\+N,\+V,\+T) calculation.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespacemod__loops_a6e4de9cf9c585c364502a63d328071bd}{calc}
\begin{DoxyCompactList}\small\item\em This routine performs the main loop and calls subroutine s to perform the configurational sampling and energy calculations. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacemod__loops_a755c1c6e9232a99181d4ac9a7c0c5cff}{recalc}
\begin{DoxyCompactList}\small\item\em This routine performs the main loop and reads already calculated energy values from energy file. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacemod__loops_acfec0f16ef59b6277e9dfd13d5026965}{calc\+\_\+ztotal}
\begin{DoxyCompactList}\small\item\em This routine performs partition function calculation for each grid point and also for the whole grid. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
character(len=4) \hyperlink{namespacemod__loops_a79e040eb372f8de350337242a159e2b7}{ntra}
\item 
character(len=4) \hyperlink{namespacemod__loops_a2ee60c7992c0befa3757b0996e34c356}{nreo}
\item 
character(len=4) \hyperlink{namespacemod__loops_aa5002187d8846b45d30e6d3845cf1301}{ngyr}
\item 
real(kind=dp) \hyperlink{namespacemod__loops_ab6a118712ba0b676790e9cace45c35b5}{t0}
\item 
real(kind=dp) \hyperlink{namespacemod__loops_acb345fb5782ee4c7fd3c419baff2c135}{time}
\item 
real(kind=dp) \hyperlink{namespacemod__loops_a28f32cc48dca88b5eb914f3b51ff36c4}{kbt}
\item 
real(kind=dp) \hyperlink{namespacemod__loops_a17eba688dba567d251d70c4c22d9a1cb}{min\+\_\+ener}
\item 
real(kind=dp) \hyperlink{namespacemod__loops_a16597662d980828d74a9078f4b74e677}{atotal}
\item 
real(kind=dp) \hyperlink{namespacemod__loops_ae00fd72d753b56050294575eca6b68b1}{mtstotal}
\item 
real(kind=dp) \hyperlink{namespacemod__loops_ad69a647146ed54f5c84b96e742396716}{etotalavg}
\item 
real(kind=dp) \hyperlink{namespacemod__loops_a6975a502e7bc56e3b95ee8ed8db8e658}{ztrans}
\item 
real(kind=dp) \hyperlink{namespacemod__loops_a7c4cc7b204cbf0459e4519befe2b1ef5}{sumvexpvtrans}
\item 
real(kind=dp), dimension(\+:), allocatable \hyperlink{namespacemod__loops_a285da08b33e0b132d883ee82f39f6ea2}{min\+\_\+ener\+\_\+t}
\item 
integer \hyperlink{namespacemod__loops_adc96eb69b7265038868c81104240ee96}{tini}
\item 
integer \hyperlink{namespacemod__loops_a67ea99979384ac6268ae84f7bd2773ec}{tend}
\item 
integer \hyperlink{namespacemod__loops_ab4cd7025ac3ba99baaa6d706f7c7cdb7}{rate}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This module contains the main program loop for Z(\+N,\+V,\+T) calculation. 

\begin{DoxyAuthor}{Author}
Felippe M. Colombari
\begin{DoxyItemize}
\item Laboratório de Química Teórica, L\+QT -- U\+F\+S\+Car 
\end{DoxyItemize}
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
-\/ Oct, 2017
\begin{DoxyItemize}
\item module created 
\end{DoxyItemize}
\end{DoxyDate}


\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacemod__loops_a6e4de9cf9c585c364502a63d328071bd}\label{namespacemod__loops_a6e4de9cf9c585c364502a63d328071bd}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!calc@{calc}}
\index{calc@{calc}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{calc()}{calc()}}
{\footnotesize\ttfamily subroutine mod\+\_\+loops\+::calc (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



This routine performs the main loop and calls subroutine s to perform the configurational sampling and energy calculations. 

\begin{DoxyAuthor}{Author}
Felippe M. Colombari
\begin{DoxyItemize}
\item Laboratório de Química Teórica, L\+QT -- U\+F\+S\+Car 
\end{DoxyItemize}
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
-\/ Jun, 2017
\begin{DoxyItemize}
\item subroutine created
\item energy values written in binary file 
\end{DoxyItemize}

-\/ Dec, 2017
\begin{DoxyItemize}
\item lowest energy values are subtracted from each value to avoid problems due to exponential explosion 
\end{DoxyItemize}
\end{DoxyDate}


Definition at line 40 of file mod\+\_\+loops.\+f90.



References mod\+\_\+input\+\_\+read\+::atom\+\_\+overlap, mod\+\_\+read\+\_\+grids\+::check\+\_\+moves(), mod\+\_\+read\+\_\+molecules\+::cosphir, mod\+\_\+read\+\_\+molecules\+::costhetar, mod\+\_\+read\+\_\+molecules\+::dimers, mod\+\_\+read\+\_\+grids\+::grid\+\_\+reo, mod\+\_\+read\+\_\+grids\+::grid\+\_\+trans, mod\+\_\+input\+\_\+read\+::gyr\+\_\+factor, mod\+\_\+input\+\_\+read\+::inter\+\_\+energy, mod\+\_\+constants\+::kb, kbt, mod\+\_\+pot\+\_\+ljc\+\_\+pair\+::ljc\+\_\+pair\+\_\+dimers, min\+\_\+ener, min\+\_\+ener\+\_\+t, mod\+\_\+read\+\_\+molecules\+::mol1, mod\+\_\+pot\+\_\+bhc\+::mol1\+\_\+bhc, mod\+\_\+read\+\_\+molecules\+::mol2, mod\+\_\+pot\+\_\+bhc\+::mol2\+\_\+bhc, mod\+\_\+pot\+\_\+ljc\+::mol2\+\_\+ljc, mod\+\_\+read\+\_\+grids\+::phir, mod\+\_\+input\+\_\+read\+::potential, rate, mod\+\_\+input\+\_\+read\+::ref2, mod\+\_\+read\+\_\+grids\+::rot\+\_\+total, mod\+\_\+read\+\_\+molecules\+::sinphir, mod\+\_\+read\+\_\+molecules\+::sinthetar, mod\+\_\+read\+\_\+grids\+::sumvexpvrot, t0, mod\+\_\+input\+\_\+read\+::temp, tend, mod\+\_\+read\+\_\+grids\+::thetar, time, tini, mod\+\_\+input\+\_\+read\+::writeframe, mod\+\_\+input\+\_\+read\+::wrtxtc, and mod\+\_\+read\+\_\+grids\+::zrot.



Referenced by themis().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=322pt]{namespacemod__loops_a6e4de9cf9c585c364502a63d328071bd_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemod__loops_acfec0f16ef59b6277e9dfd13d5026965}\label{namespacemod__loops_acfec0f16ef59b6277e9dfd13d5026965}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!calc\+\_\+ztotal@{calc\+\_\+ztotal}}
\index{calc\+\_\+ztotal@{calc\+\_\+ztotal}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{calc\+\_\+ztotal()}{calc\_ztotal()}}
{\footnotesize\ttfamily subroutine mod\+\_\+loops\+::calc\+\_\+ztotal (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



This routine performs partition function calculation for each grid point and also for the whole grid. 

\begin{DoxyAuthor}{Author}
Felippe M. Colombari
\begin{DoxyItemize}
\item Laboratório de Química Teórica, L\+QT -- U\+F\+S\+Car 
\end{DoxyItemize}
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
-\/ Jun, 2017
\begin{DoxyItemize}
\item subroutine created 
\end{DoxyItemize}

-\/ Dec, 2017
\begin{DoxyItemize}
\item absolute energy values are recovered and thermodynamic properties are obtained from them 
\end{DoxyItemize}

-\/ Mar, 2019
\begin{DoxyItemize}
\item -\/\+TdS from ideal gas is subtracted from free energy 
\end{DoxyItemize}
\end{DoxyDate}


Definition at line 480 of file mod\+\_\+loops.\+f90.



References mod\+\_\+read\+\_\+grids\+::a, atotal, mod\+\_\+read\+\_\+grids\+::eavg, etotalavg, mod\+\_\+read\+\_\+grids\+::grid\+\_\+reo, mod\+\_\+read\+\_\+grids\+::grid\+\_\+trans, mod\+\_\+input\+\_\+read\+::gyr\+\_\+factor, mod\+\_\+input\+\_\+read\+::inter\+\_\+energy, mod\+\_\+constants\+::kb, kbt, min\+\_\+ener, min\+\_\+ener\+\_\+t, mod\+\_\+read\+\_\+grids\+::mts, mtstotal, mod\+\_\+read\+\_\+grids\+::probt, mod\+\_\+read\+\_\+grids\+::sumvexpvrot, sumvexpvtrans, mod\+\_\+input\+\_\+read\+::temp, mod\+\_\+read\+\_\+grids\+::zrot, and ztrans.



Referenced by themis().

\mbox{\Hypertarget{namespacemod__loops_a755c1c6e9232a99181d4ac9a7c0c5cff}\label{namespacemod__loops_a755c1c6e9232a99181d4ac9a7c0c5cff}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!recalc@{recalc}}
\index{recalc@{recalc}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{recalc()}{recalc()}}
{\footnotesize\ttfamily subroutine mod\+\_\+loops\+::recalc (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



This routine performs the main loop and reads already calculated energy values from energy file. 

\begin{DoxyAuthor}{Author}
Felippe M. Colombari
\begin{DoxyItemize}
\item Laboratório de Química Teórica, L\+QT -- U\+F\+S\+Car 
\end{DoxyItemize}
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
-\/ Jun, 2017
\begin{DoxyItemize}
\item subroutine created
\item energy values read from binary file 
\end{DoxyItemize}

-\/ Dec, 2017
\begin{DoxyItemize}
\item lowest energy values are subtracted from each value to avoid problems in exponential calculation 
\end{DoxyItemize}
\end{DoxyDate}


Definition at line 327 of file mod\+\_\+loops.\+f90.



References mod\+\_\+read\+\_\+grids\+::check\+\_\+moves(), mod\+\_\+read\+\_\+grids\+::grid\+\_\+reo, mod\+\_\+read\+\_\+grids\+::grid\+\_\+trans, mod\+\_\+input\+\_\+read\+::gyr\+\_\+factor, mod\+\_\+inquire\+::inquire\+\_\+file(), mod\+\_\+input\+\_\+read\+::inter\+\_\+energy, mod\+\_\+constants\+::kb, kbt, min\+\_\+ener, min\+\_\+ener\+\_\+t, mod\+\_\+input\+\_\+read\+::potential, mod\+\_\+input\+\_\+read\+::scale\+\_\+factor, mod\+\_\+read\+\_\+grids\+::sumvexpvrot, mod\+\_\+input\+\_\+read\+::temp, and mod\+\_\+read\+\_\+grids\+::zrot.



Referenced by themis().

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{namespacemod__loops_a755c1c6e9232a99181d4ac9a7c0c5cff_cgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespacemod__loops_a16597662d980828d74a9078f4b74e677}\label{namespacemod__loops_a16597662d980828d74a9078f4b74e677}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!atotal@{atotal}}
\index{atotal@{atotal}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{atotal}{atotal}}
{\footnotesize\ttfamily real( kind = dp ) mod\+\_\+loops\+::atotal}



Definition at line 19 of file mod\+\_\+loops.\+f90.



Referenced by calc\+\_\+ztotal(), and mod\+\_\+resume\+::sort\+\_\+output().

\mbox{\Hypertarget{namespacemod__loops_ad69a647146ed54f5c84b96e742396716}\label{namespacemod__loops_ad69a647146ed54f5c84b96e742396716}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!etotalavg@{etotalavg}}
\index{etotalavg@{etotalavg}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{etotalavg}{etotalavg}}
{\footnotesize\ttfamily real( kind = dp ) mod\+\_\+loops\+::etotalavg}



Definition at line 19 of file mod\+\_\+loops.\+f90.



Referenced by calc\+\_\+ztotal(), and mod\+\_\+resume\+::sort\+\_\+output().

\mbox{\Hypertarget{namespacemod__loops_a28f32cc48dca88b5eb914f3b51ff36c4}\label{namespacemod__loops_a28f32cc48dca88b5eb914f3b51ff36c4}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!kbt@{kbt}}
\index{kbt@{kbt}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{kbt}{kbt}}
{\footnotesize\ttfamily real( kind = dp ) mod\+\_\+loops\+::kbt}



Definition at line 18 of file mod\+\_\+loops.\+f90.



Referenced by calc(), calc\+\_\+ztotal(), mod\+\_\+search\+::count\+\_\+structures(), recalc(), mod\+\_\+search\+::sort\+\_\+energy(), and mod\+\_\+resume\+::sort\+\_\+output().

\mbox{\Hypertarget{namespacemod__loops_a17eba688dba567d251d70c4c22d9a1cb}\label{namespacemod__loops_a17eba688dba567d251d70c4c22d9a1cb}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!min\+\_\+ener@{min\+\_\+ener}}
\index{min\+\_\+ener@{min\+\_\+ener}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{min\+\_\+ener}{min\_ener}}
{\footnotesize\ttfamily real( kind = dp ) mod\+\_\+loops\+::min\+\_\+ener}



Definition at line 18 of file mod\+\_\+loops.\+f90.



Referenced by calc(), calc\+\_\+ztotal(), mod\+\_\+search\+::count\+\_\+structures(), mod\+\_\+resume\+::ending(), recalc(), mod\+\_\+search\+::sort\+\_\+energy(), and mod\+\_\+resume\+::sort\+\_\+output().

\mbox{\Hypertarget{namespacemod__loops_a285da08b33e0b132d883ee82f39f6ea2}\label{namespacemod__loops_a285da08b33e0b132d883ee82f39f6ea2}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!min\+\_\+ener\+\_\+t@{min\+\_\+ener\+\_\+t}}
\index{min\+\_\+ener\+\_\+t@{min\+\_\+ener\+\_\+t}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{min\+\_\+ener\+\_\+t}{min\_ener\_t}}
{\footnotesize\ttfamily real( kind = dp ), dimension(\+:), allocatable mod\+\_\+loops\+::min\+\_\+ener\+\_\+t}



Definition at line 21 of file mod\+\_\+loops.\+f90.



Referenced by calc(), calc\+\_\+ztotal(), mod\+\_\+deallocate\+\_\+all\+::deallocate\+\_\+arrays(), and recalc().

\mbox{\Hypertarget{namespacemod__loops_ae00fd72d753b56050294575eca6b68b1}\label{namespacemod__loops_ae00fd72d753b56050294575eca6b68b1}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!mtstotal@{mtstotal}}
\index{mtstotal@{mtstotal}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{mtstotal}{mtstotal}}
{\footnotesize\ttfamily real( kind = dp ) mod\+\_\+loops\+::mtstotal}



Definition at line 19 of file mod\+\_\+loops.\+f90.



Referenced by calc\+\_\+ztotal(), and mod\+\_\+resume\+::sort\+\_\+output().

\mbox{\Hypertarget{namespacemod__loops_aa5002187d8846b45d30e6d3845cf1301}\label{namespacemod__loops_aa5002187d8846b45d30e6d3845cf1301}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!ngyr@{ngyr}}
\index{ngyr@{ngyr}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{ngyr}{ngyr}}
{\footnotesize\ttfamily character( len = 4 ) mod\+\_\+loops\+::ngyr}



Definition at line 17 of file mod\+\_\+loops.\+f90.

\mbox{\Hypertarget{namespacemod__loops_a2ee60c7992c0befa3757b0996e34c356}\label{namespacemod__loops_a2ee60c7992c0befa3757b0996e34c356}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!nreo@{nreo}}
\index{nreo@{nreo}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{nreo}{nreo}}
{\footnotesize\ttfamily character( len = 4 ) mod\+\_\+loops\+::nreo}



Definition at line 17 of file mod\+\_\+loops.\+f90.

\mbox{\Hypertarget{namespacemod__loops_a79e040eb372f8de350337242a159e2b7}\label{namespacemod__loops_a79e040eb372f8de350337242a159e2b7}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!ntra@{ntra}}
\index{ntra@{ntra}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{ntra}{ntra}}
{\footnotesize\ttfamily character( len = 4 ) mod\+\_\+loops\+::ntra}



Definition at line 17 of file mod\+\_\+loops.\+f90.

\mbox{\Hypertarget{namespacemod__loops_ab4cd7025ac3ba99baaa6d706f7c7cdb7}\label{namespacemod__loops_ab4cd7025ac3ba99baaa6d706f7c7cdb7}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!rate@{rate}}
\index{rate@{rate}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{rate}{rate}}
{\footnotesize\ttfamily integer mod\+\_\+loops\+::rate}



Definition at line 22 of file mod\+\_\+loops.\+f90.



Referenced by calc().

\mbox{\Hypertarget{namespacemod__loops_a7c4cc7b204cbf0459e4519befe2b1ef5}\label{namespacemod__loops_a7c4cc7b204cbf0459e4519befe2b1ef5}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!sumvexpvtrans@{sumvexpvtrans}}
\index{sumvexpvtrans@{sumvexpvtrans}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{sumvexpvtrans}{sumvexpvtrans}}
{\footnotesize\ttfamily real( kind = dp ) mod\+\_\+loops\+::sumvexpvtrans}



Definition at line 20 of file mod\+\_\+loops.\+f90.



Referenced by calc\+\_\+ztotal().

\mbox{\Hypertarget{namespacemod__loops_ab6a118712ba0b676790e9cace45c35b5}\label{namespacemod__loops_ab6a118712ba0b676790e9cace45c35b5}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!t0@{t0}}
\index{t0@{t0}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{t0}{t0}}
{\footnotesize\ttfamily real( kind = dp ) mod\+\_\+loops\+::t0}



Definition at line 18 of file mod\+\_\+loops.\+f90.



Referenced by calc().

\mbox{\Hypertarget{namespacemod__loops_a67ea99979384ac6268ae84f7bd2773ec}\label{namespacemod__loops_a67ea99979384ac6268ae84f7bd2773ec}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!tend@{tend}}
\index{tend@{tend}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{tend}{tend}}
{\footnotesize\ttfamily integer mod\+\_\+loops\+::tend}



Definition at line 22 of file mod\+\_\+loops.\+f90.



Referenced by calc().

\mbox{\Hypertarget{namespacemod__loops_acb345fb5782ee4c7fd3c419baff2c135}\label{namespacemod__loops_acb345fb5782ee4c7fd3c419baff2c135}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!time@{time}}
\index{time@{time}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{time}{time}}
{\footnotesize\ttfamily real( kind = dp ) mod\+\_\+loops\+::time}



Definition at line 18 of file mod\+\_\+loops.\+f90.



Referenced by calc().

\mbox{\Hypertarget{namespacemod__loops_adc96eb69b7265038868c81104240ee96}\label{namespacemod__loops_adc96eb69b7265038868c81104240ee96}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!tini@{tini}}
\index{tini@{tini}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{tini}{tini}}
{\footnotesize\ttfamily integer mod\+\_\+loops\+::tini}



Definition at line 22 of file mod\+\_\+loops.\+f90.



Referenced by calc().

\mbox{\Hypertarget{namespacemod__loops_a6975a502e7bc56e3b95ee8ed8db8e658}\label{namespacemod__loops_a6975a502e7bc56e3b95ee8ed8db8e658}} 
\index{mod\+\_\+loops@{mod\+\_\+loops}!ztrans@{ztrans}}
\index{ztrans@{ztrans}!mod\+\_\+loops@{mod\+\_\+loops}}
\subsubsection{\texorpdfstring{ztrans}{ztrans}}
{\footnotesize\ttfamily real( kind = dp ) mod\+\_\+loops\+::ztrans}



Definition at line 20 of file mod\+\_\+loops.\+f90.



Referenced by calc\+\_\+ztotal(), mod\+\_\+search\+::sort\+\_\+energy(), and mod\+\_\+resume\+::sort\+\_\+output().

